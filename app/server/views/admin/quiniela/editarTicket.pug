extends ../partials/layout

block head
    title Editar ticket

block content
    div(ng-app="dashboard")
        div
            include ../partials/navbar
        div.container-fluid
            div.row
                include ../partials/sidebar
                div.col-sm-9.col-sm-offset-3.col-md-10.col-md-offset-2.col-xs-12.main(ng-controller="TicketController")
                    h1.page-header(style="padding-top: 0px;") Editar ticket

                    form.form-horizontal(style="margin-top: 15px", ng-show="!consultando", ng-cloak)
                        div.form-group
                            label.col-sm-2.control-label Temporada:
                            div.col-sm-4
                                //input(ng-model="quiniela.temporada", placeholder="XXXX-YYYY").form-control
                                input(ng-model="quiniela.temporada", placeholder="XXXX-YYYY", , uib-typeahead="temporada.value as temporada.name for temporada in temporadas | filter:{name:$viewValue}").form-control
                        div.form-group
                            label.col-sm-2.control-label Modalidad:
                            div.col-sm-4
                                input(ng-model="quiniela.modalidad").form-control
                        div.form-group
                            label.col-sm-2.control-label Fecha:
                            div.col-sm-4
                                input(ng-model="quiniela.fecha", placeholder="dd/MM/yyyy").form-control
                        div.form-group
                            label.col-sm-2.control-label Jornada:
                            div.col-sm-4
                                input(ng-model="quiniela.jornada", placeholder="Identificador del ticket en la temporada").form-control
                        div.form-group
                            label.col-sm-2.control-label Precio:
                            div.col-sm-4
                                input(ng-model="quiniela.precio").form-control
                        div.form-group
                            label.col-sm-2.control-label Premio:
                            div.col-sm-4
                                input(ng-model="quiniela.premio").form-control


                        div.col-md-4.col-md-offset-8
                            a.pull-right(href="", ng-click="anadirPronostico()").pointer Añadir pronóstico
                        div.col-md-4.col-md-offset-8
                            a.pull-right(href="", ng-click="eliminarPronostico()").pointer Eliminar pronóstico


                        //pre {{quiniela}}

                        div.table-responsive
                            table.table.table-bordered.col-md-12.col-sm-12.col-xs-12
                                thead
                                    tr(ng-show="quiniela.partidos[0].pronosticos.length > 0", ng-cloak)
                                        th(colspan="9")
                                        th(colspan="{{quiniela.partidos[0].pronosticos.length}}") Pronósticos
                                    tr
                                        th Fila
                                        //th Temporada
                                        th Competición
                                        th Jornada
                                        th Local
                                        th Goles L.
                                        th Goles V.
                                        th Visitante
                                        th Resultado
                                        th R. Pleno
                                        th(ng-repeat="pronostico in quiniela.partidos[0].pronosticos track by $index", ng-bind-template="{{$index + 1}}")




                                tbody
                                    tr(ng-repeat="partido in quiniela.partidos")
                                        td(ng-bind-template="{{partido.fila}}")
                                        //td
                                            input.form-control(ng-model="partido.temporada")
                                        td(style="min-width: 150px")
                                            //input.form-control(ng-model="partido.competicion")
                                            input#competicionSeleccionada(type="text", placeholder="Todas", ng-model="partido.competicion", uib-typeahead="competicion.value as competicion.name for competicion in competiciones | filter:{name:$viewValue}").form-control
                                        td
                                            input.form-control(ng-model="partido.jornada").text-center
                                        td(style="min-width: 200px")
                                            //input.form-control(ng-model="partido.local")
                                            input#equipoSeleccionado.form-control(ng-model="partido.local", placeholder="Equipo", uib-typeahead="equipo.value as equipo.name for equipo in equipos | filter:{name:$viewValue} | orderBy:'name'")
                                        td
                                            input.form-control(ng-model="partido.golesLocal").text-center
                                        td
                                            input.form-control(ng-model="partido.golesVisitante").text-center
                                        td(style="min-width: 200px")
                                            //input.form-control(ng-model="partido.visitante")
                                            input#equipoSeleccionado.form-control(ng-model="partido.visitante", placeholder="Equipo", uib-typeahead="equipo.value as equipo.name for equipo in equipos | filter:{name:$viewValue} | orderBy:'name'")
                                        td
                                            input.form-control(ng-model="partido.resultado").text-center
                                        td(ng-show="partido.fila == 15")
                                            input.form-control(ng-model="partido.resultadoConGoles").text-center
                                        td(ng-show="partido.fila < 15")
                                            | N/A
                                        td(style="min-width: 60px", ng-repeat="pronostico in partido.pronosticos", ng-show="partido.fila < 15")
                                            input.form-control(ng-model="pronostico.signo").text-center
                                        td(style="min-width: 60px", ng-show="partido.fila == 15 && quiniela.partidos[0].pronosticos != null", colspan="{{quiniela.partidos[0].pronosticos.length}}")
                                            input.form-control(ng-show="quiniela.partidos[0].pronosticos.length > 0", ng-cloak, ng-model="partido.pronosticos[0].signo").text-center


                        div.form-group
                            div.col-sm-2.col-sm-offset-2
                                a.btn.btn-default(href="/admin/quiniela", role="button")#cancel Cancelar
                            div.col-sm-2(style="text-align:right")
                                a.btn.btn-default.btn-primary(href="#", role="button", ng-click="guardar()")#confirmarEliminacion Aceptar


                        //pre {{quiniela.partidos[0].pronosticos}}

                        //pre {{ticket}}

                        include ../../modals/registroEditadoCorrectamente

block scripts
    script(src="/js/jquery.js")
    script(src="/js/bootstrap.js")
    script(src="/js/angular.js")
    script(src="/js/angular/admin/dashboard.js")
    script(src="/js/angular/admin/quiniela/editarTicket.js")
    script(src="/js/angular/admin/navbar.js")
    script(src="/js/angular/admin/sidebar.js")
    script(src='/js/angular/ui-bootstrap-tpls-1.3.3.js')
